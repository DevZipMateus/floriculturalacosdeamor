import { useEffect } from 'react';
import { useParams, Navigate } from 'react-router-dom';

// Mapeamento de IDs para arquivos reais baseado na galeria
const imageMap: { [key: string]: string } = {
  // Coroas
  "1436283747534662": "1436283747534662.jpeg",
  "1277281734403665": "1277281734403665.jpeg",
  "685492667537964": "685492667537964.jpeg",
  "722629856878437": "722629856878437.jpeg",
  "2071026940064082": "2071026940064082.jpeg",
  "725832239870131": "725832239870131.jpeg",
  "591988233337107": "591988233337107.jpeg",
  "1194352558603841": "1194352558603841.jpeg",
  "1350057442775322": "1350057442775322.jpeg",
  "1277262153764645": "1277262153764645.jpeg",
  "1333631967727619": "1333631967727619.jpeg",
  "1947127676039578": "1947127676039578.jpeg",
  "566701519418918": "566701519418918.jpeg",
  "1039514588126578": "1039514588126578.jpeg",
  "1211310727385237": "1211310727385237.jpeg",
  "1149602736833315": "1149602736833315.jpeg",
  "712547001297230": "712547001297230.jpeg",
  "656723930462256": "656723930462256.jpeg",
  "688949820752847": "688949820752847.jpeg",
  "997127589251004": "997127589251004.jpeg",
  "711578444721504": "711578444721504.jpeg",
  "1267246988441755": "1267246988441755.jpeg",
  "677756168438687": "677756168438687.jpeg",
  "1322423835484813": "1322423835484813.jpeg",
  "956824869722757": "956824869722757.jpeg",
  "1338752984021341": "1338752984021341.jpeg",
  "1400186854324384": "1400186854324384.jpeg",
  "1879302432803728": "1879302432803728.jpeg",
  "1378690923277082": "1378690923277082.jpeg",
  "1429297048080098": "1429297048080098.jpeg",
  "4133203780233785": "4133203780233785.jpeg",
  "1600599350896481": "1600599350896481.jpeg",
  "30626077246991276": "30626077246991276.jpeg",
  "1896782404474502": "1896782404474502.jpeg",
  
  // Buques
  "1221306166442975": "1221306166442975.jpeg",
  "625072200556953": "625072200556953.jpeg",
  "1322967455452254": "1322967455452254.jpeg",
  "1066575648693097": "1066575648693097.jpeg",
  "1088807276410764": "1088807276410764.jpeg",
  "1216088486633199": "1216088486633199.jpeg",
  "1213863113743969": "1213863113743969.jpeg",
  "1444158630330084": "1444158630330084.jpeg",
  "1744257336484288": "1744257336484288.jpeg",
  "2457499654597496": "2457499654597496.jpeg",
  "1379703456612614": "1379703456612614.jpeg",
  "722094213661886": "722094213661886.jpeg",
  "626066910477203": "626066910477203.jpeg",
  "1411612573488350": "1411612573488350.jpeg",
  "589999074131900": "589999074131900.jpeg",
  "4136915633234331": "4136915633234331.jpeg",
  "920803230103770": "920803230103770.jpeg",
  "1497434104563077": "1497434104563077.jpeg",
  "1570604174326565": "1570604174326565.jpeg",
  "1032290782201299": "1032290782201299.jpeg",
  "1855450545234363": "1855450545234363.jpeg",
  "1715461362418119": "1715461362418119.jpeg",
  "2447220618986222": "2447220618986222.jpeg",
  "1078517857501677": "1078517857501677.jpeg",
  
  // Cestas
  "1638596034198425": "1638596034198425.jpeg",
  "1025678579199601": "1025678579199601.jpeg",
  "1022411606210524": "1022411606210524.jpeg",
  "1022540286729732": "1022540286729732.jpeg",
  "10004239452945980": "10004239452945980.jpeg"
};

const ProductRedirect = () => {
  const { id } = useParams<{ id: string }>();

  useEffect(() => {
    if (id && imageMap[id]) {
      // Verificar se a imagem existe antes de redirecionar
      const imageUrl = `/galeria/${imageMap[id]}`;
      const img = new Image();
      
      img.onload = () => {
        // Imagem existe, redirecionar
        window.location.href = imageUrl;
      };
      
      img.onerror = () => {
        // Imagem não existe, redirecionar para galeria
        console.warn(`Imagem não encontrada: ${imageUrl}`);
        window.location.href = '/#galeria';
      };
      
      img.src = imageUrl;
    }
  }, [id]);

  // Se o ID não existir no mapeamento, redirecionar para a galeria
  if (!id || !imageMap[id]) {
    return <Navigate to="/#galeria" replace />;
  }

  // Mostrar loading enquanto redireciona
  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="text-center">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto mb-4"></div>
        <p className="text-muted-foreground">Redirecionando para a imagem...</p>
      </div>
    </div>
  );
};

export default ProductRedirect;